const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./web.C8LvoEPP.js","./index.C9AwUYvo.js","./web.DCfE97fL.js"])))=>i.map(i=>d[i]);
import{d as Be,a as R,n as le,b as $}from"./disclose-version.BI_BLsxB.js";import{w as B,y as ce,o as Qe,m as Ke,z as Xe,A as Je,I as Ze,U as ze,ac as $e,ad as be,O as fe,x as K,P as et,at as ie,ab as Me,B as Pe,Z as tt,q as re,au as at,av as st,S as it,aw as nt,D as rt,J as Ve,X as ot,a5 as Ee,ax as lt,ay as ut,az as ct,M as ft,aa as Oe,aA as vt,aB as dt,E as _t,aC as yt,aD as ht,ae as wt,b as mt,aE as pt,ag as gt,C as X,aF as bt,G as Le,H as Ce,p as pe,aG as ve,aH as Et,i as oe,j as ge,g as p,aI as de,k as L,l as O,t as Y,s as z,e as W,Y as J,a1 as Ot}from"./runtime.zDXwUdKf.js";import{d as Lt,a as ne,e as Ue}from"./store.BLcRvefV.js";import{p as E,i as Z,b as Ct,a as ae,o as Dt}from"./index-client.DNmrXPuZ.js";import{g as At}from"./entry.UA93HLbR.js";import{_ as Fe}from"./preload-helper.C1FmrZbK.js";import{r as We,C as _e}from"./index.C9AwUYvo.js";import"./legacy.DD9LzAr7.js";import{i as Nt}from"./lifecycle.DXu0ucaD.js";function qt(a,e){return e}function It(a,e,t,s){for(var i=[],n=e.length,r=0;r<n;r++)st(e[r].e,i,!0);var u=n>0&&i.length===0&&t!==null;if(u){var l=t.parentNode;it(l),l.append(t),s.clear(),P(a,e[0].prev,e[n-1].next)}nt(i,()=>{for(var c=0;c<n;c++){var o=e[c];u||(s.delete(o.k),P(a,o.prev,o.next)),rt(o.e,!u)}})}function St(a,e,t,s,i,n=null){var r=a,u={flags:e,items:new Map,first:null};{var l=a;r=B?ce(Qe(l)):l.appendChild(Ke())}B&&Xe();var c=null,o=!1;Je(()=>{var y=t(),f=Ze(y)?y:y==null?[]:ze(y),v=f.length;if(o&&v===0)return;o=v===0;let _=!1;if(B){var w=r.data===$e;w!==(v===0)&&(r=be(),ce(r),fe(!1),_=!0)}if(B){for(var g=null,h,m=0;m<v;m++){if(K.nodeType===8&&K.data===et){r=K,_=!0,fe(!1);break}var A=f[m],C=s(A,m);h=je(K,u,g,null,A,C,m,i,e),u.items.set(C,h),g=h}v>0&&ce(be())}if(!B){var b=Ve;xt(f,u,r,i,e,(b.f&ie)!==0,s)}n!==null&&(v===0?c?Me(c):c=Pe(()=>n(r)):c!==null&&tt(c,()=>{c=null})),_&&fe(!0),t()}),B&&(r=K)}function xt(a,e,t,s,i,n,r){var u=a.length,l=e.items,c=e.first,o=c,y,f=null,v=[],_=[],w,g,h,m;for(m=0;m<u;m+=1){if(w=a[m],g=r(w,m),h=l.get(g),h===void 0){var A=o?o.e.nodes_start:t;f=je(A,e,f,f===null?e.first:f.next,w,g,m,s,i),l.set(g,f),v=[],_=[],o=f.next;continue}if(Tt(h,w,m),h.e.f&ie&&Me(h.e),h!==o){if(y!==void 0&&y.has(h)){if(v.length<_.length){var C=_[0],b;f=C.prev;var S=v[0],x=v[v.length-1];for(b=0;b<v.length;b+=1)De(v[b],C,t);for(b=0;b<_.length;b+=1)y.delete(_[b]);P(e,S.prev,x.next),P(e,f,S),P(e,x,C),o=C,f=x,m-=1,v=[],_=[]}else y.delete(h),De(h,o,t),P(e,h.prev,h.next),P(e,h,f===null?e.first:f.next),P(e,f,h),f=h;continue}for(v=[],_=[];o!==null&&o.k!==g;)(n||!(o.e.f&ie))&&(y??(y=new Set)).add(o),_.push(o),o=o.next;if(o===null)continue;h=o}v.push(h),f=h,o=h.next}if(o!==null||y!==void 0){for(var I=y===void 0?[]:ze(y);o!==null;)(n||!(o.e.f&ie))&&I.push(o),o=o.next;var T=I.length;if(T>0){var j=u===0?t:null;It(e,I,j,l)}}re.first=e.first&&e.first.e,re.last=f&&f.e}function Tt(a,e,t,s){at(a.v,e),a.i=t}function je(a,e,t,s,i,n,r,u,l){var c=(l&ut)!==0,o=(l&ct)===0,y=c?o?ot(i):Ee(i):i,f=l&lt?Ee(r):r,v={i:f,v:y,k:n,a:null,e:null,prev:t,next:s};try{return v.e=Pe(()=>u(a,y,f),B),v.e.prev=t&&t.e,v.e.next=s&&s.e,t===null?e.first=v:(t.next=v,t.e.next=v.e),s!==null&&(s.prev=v,s.e.prev=v.e),v}finally{}}function De(a,e,t){for(var s=a.next?a.next.e.nodes_start:t,i=e?e.e.nodes_start:t,n=a.e.nodes_start;n!==s;){var r=ft(n);i.before(n),n=r}}function P(a,e,t){e===null?a.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function q(a,e,t,s){var i=a.__attributes??(a.__attributes={});B&&(i[e]=a.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&a.nodeName==="LINK")||i[e]!==(i[e]=t)&&(e==="style"&&"__styles"in a&&(a.__styles={}),e==="loading"&&(a[vt]=t),t==null?a.removeAttribute(e):typeof t!="string"&&kt(a).includes(e)?a[e]=t:a.setAttribute(e,t))}var Ae=new Map;function kt(a){var e=Ae.get(a.nodeName);if(e)return e;Ae.set(a.nodeName,e=[]);for(var t,s=Oe(a),i=Element.prototype;i!==s;){t=dt(s);for(var n in t)t[n].set&&e.push(n);s=Oe(s)}return e}function Rt(a,e){var t=a.__className,s=Bt(e);B&&a.getAttribute("class")===s?a.__className=s:(t!==s||B&&a.getAttribute("class")!==s)&&(s===""?a.removeAttribute("class"):a.setAttribute("class",s),a.__className=s)}function Bt(a){return a??""}function M(a,e,t){if(t){if(a.classList.contains(e))return;a.classList.add(e)}else{if(!a.classList.contains(e))return;a.classList.remove(e)}}const zt=()=>performance.now(),V={tick:a=>requestAnimationFrame(a),now:()=>zt(),tasks:new Set};function He(a){V.tasks.forEach(e=>{e.c(a)||(V.tasks.delete(e),e.f())}),V.tasks.size!==0&&V.tick(He)}function Mt(a){let e;return V.tasks.size===0&&V.tick(He),{promise:new Promise(t=>{V.tasks.add(e={c:a,f:t})}),abort(){V.tasks.delete(e)}}}function se(a,e){a.dispatchEvent(new CustomEvent(e))}function Pt(a){if(a==="float")return"cssFloat";if(a==="offset")return"cssOffset";if(a.startsWith("--"))return a;const e=a.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function Ne(a){const e={},t=a.split(";");for(const s of t){const[i,n]=s.split(":");if(!i||n===void 0)break;const r=Pt(i.trim());e[r]=n.trim()}return e}const Vt=a=>a;function qe(a,e,t,s){var i=(a&bt)!==0,n="both",r,u=e.inert,l,c;function o(){var w=Ve,g=re;Le(null),Ce(null);try{return r??(r=t()(e,(s==null?void 0:s())??{},{direction:n}))}finally{Le(w),Ce(g)}}var y={is_global:i,in(){e.inert=u,se(e,"introstart"),l=we(e,o(),c,1,()=>{se(e,"introend"),l==null||l.abort(),l=r=void 0})},out(w){e.inert=!0,se(e,"outrostart"),c=we(e,o(),l,0,()=>{se(e,"outroend"),w==null||w()})},stop:()=>{l==null||l.abort(),c==null||c.abort()}},f=re;if((f.transitions??(f.transitions=[])).push(y),Lt){var v=i;if(!v){for(var _=f.parent;_&&_.f&_t;)for(;(_=_.parent)&&!(_.f&yt););v=!_||(_.f&ht)!==0}v&&wt(()=>{mt(()=>y.in())})}}function we(a,e,t,s,i){var n=s===1;if(pt(e)){var r,u=!1;return gt(()=>{if(!u){var g=e({direction:n?"in":"out"});r=we(a,g,t,s,i)}}),{abort:()=>{u=!0,r==null||r.abort()},deactivate:()=>r.deactivate(),reset:()=>r.reset(),t:()=>r.t()}}if(t==null||t.deactivate(),!(e!=null&&e.duration))return i(),{abort:X,deactivate:X,reset:X,t:()=>s};const{delay:l=0,css:c,tick:o,easing:y=Vt}=e;var f=[];if(n&&t===void 0&&(o&&o(0,1),c)){var v=Ne(c(0,1));f.push(v,v)}var _=()=>1-s,w=a.animate(f,{duration:l});return w.onfinish=()=>{var g=(t==null?void 0:t.t())??1-s;t==null||t.abort();var h=s-g,m=e.duration*Math.abs(h),A=[];if(m>0){if(c)for(var C=Math.ceil(m/16.666666666666668),b=0;b<=C;b+=1){var S=g+h*y(b/C),x=c(S,1-S);A.push(Ne(x))}_=()=>{var I=w.currentTime;return g+h*y(I/m)},o&&Mt(()=>{if(w.playState!=="running")return!1;var I=_();return o(I,1-I),!0})}w=a.animate(A,{duration:m,fill:"forwards"}),w.onfinish=()=>{_=()=>s,o==null||o(s,1-s),i()}},{abort:()=>{w&&(w.cancel(),w.effect=null,w.onfinish=X)},deactivate:()=>{i=X},reset:()=>{s===0&&(o==null||o(1,0))},t:()=>_()}}/*!
 * Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */const Ut={prefix:"fas",iconName:"square-plus",icon:[448,512,[61846,"plus-square"],"f0fe","M64 32C28.7 32 0 60.7 0 96L0 416c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-320c0-35.3-28.7-64-64-64L64 32zM200 344l0-64-64 0c-13.3 0-24-10.7-24-24s10.7-24 24-24l64 0 0-64c0-13.3 10.7-24 24-24s24 10.7 24 24l0 64 64 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-64 0 0 64c0 13.3-10.7 24-24 24s-24-10.7-24-24z"]},Ft={prefix:"fas",iconName:"plus",icon:[448,512,[10133,61543,"add"],"2b","M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z"]},Ye=We("ScreenOrientation",{web:()=>Fe(()=>import("./web.C8LvoEPP.js"),__vite__mapDeps([0,1]),import.meta.url).then(a=>new a.ScreenOrientationWeb)});/*!
 * Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */const Wt={prefix:"fab",iconName:"bluetooth-b",icon:[320,512,[],"f294","M196.48 260.023l92.626-103.333L143.125 0v206.33l-86.111-86.111-31.406 31.405 108.061 108.399L25.608 368.422l31.406 31.405 86.111-86.111L145.84 512l148.552-148.644-97.912-103.333zm40.86-102.996l-49.977 49.978-.338-100.295 50.315 50.317zM187.363 313.04l49.977 49.978-50.315 50.316.338-100.294z"]};function Ie(a,e){e&&e!=="lg"&&e!=="sm"&&e!=="xs"?a.style.fontSize=e.replace("x","em"):a.style.fontSize=""}function jt(a,e,t,s,i,n=1,r="",u=""){let l=1,c=1;i&&(i=="horizontal"?l=-1:i=="vertical"?c=-1:l=c=-1),typeof a=="string"&&(a=parseFloat(a)),typeof e=="string"&&(e=parseFloat(e)),typeof t=="string"&&(t=parseFloat(t));const o=`${e*n}${r}`,y=`${t*n}${r}`;let f=`translate(${o},${y}) scale(${l*a},${c*a})`;return s&&(f+=` rotate(${s}${u})`),f}var Ht=le('<title class="svelte-bvo74f"> </title>'),Yt=le('<path class="svelte-bvo74f"></path>'),Gt=le('<path class="svelte-bvo74f"></path><path class="svelte-bvo74f"></path>',1),Qt=le('<svg aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg"><!><g class="svelte-bvo74f"><g class="svelte-bvo74f"><!></g></g></svg>');function me(a,e){pe(e,!1);const t=de(),s=de();let i=E(e,"class",24,()=>{}),n=E(e,"id",24,()=>{}),r=E(e,"style",24,()=>{}),u=E(e,"icon",8),l=E(e,"title",24,()=>{}),c=E(e,"size",24,()=>{}),o=E(e,"color",24,()=>{}),y=E(e,"fw",8,!1),f=E(e,"pull",24,()=>{}),v=E(e,"scale",8,1),_=E(e,"translateX",8,0),w=E(e,"translateY",8,0),g=E(e,"rotate",24,()=>{}),h=E(e,"flip",24,()=>{}),m=E(e,"spin",8,!1),A=E(e,"pulse",8,!1),C=E(e,"primaryColor",8,""),b=E(e,"secondaryColor",8,""),S=E(e,"primaryOpacity",8,1),x=E(e,"secondaryOpacity",8,.4),I=E(e,"swapOpacity",8,!1),T=de();ve(()=>(p(T),W(c()),Ie),()=>{p(T)&&c()&&Ie(p(T),c())}),ve(()=>W(u()),()=>{J(t,u()&&u().icon||[0,0,"",[],""])}),ve(()=>(W(v()),W(_()),W(w()),W(g()),W(h())),()=>{J(s,jt(v(),_(),w(),g(),h(),512))}),Et(),Nt();var j=Be(),ee=oe(j);Z(ee,()=>p(t)[4],G=>{var N=Qt(),Q=L(N);Z(Q,l,U=>{var k=Ht(),F=L(k,!0);O(k),Y(()=>ne(F,l())),R(U,k)});var H=z(Q),ue=L(H),Ge=L(ue);Z(Ge,()=>typeof p(t)[4]=="string",U=>{var k=Yt();Y(()=>{q(k,"d",p(t)[4]),q(k,"fill",o()||C()||"currentColor"),q(k,"transform",`translate(${p(t)[0]/-2} ${p(t)[1]/-2})`)}),R(U,k)},U=>{var k=Gt(),F=oe(k),te=z(F);Y(()=>{q(F,"d",p(t)[4][0]),q(F,"fill",b()||o()||"currentColor"),q(F,"fill-opacity",I()!=!1?S():x()),q(F,"transform",`translate(${p(t)[0]/-2} ${p(t)[1]/-2})`),q(te,"d",p(t)[4][1]),q(te,"fill",C()||o()||"currentColor"),q(te,"fill-opacity",I()!=!1?x():S()),q(te,"transform",`translate(${p(t)[0]/-2} ${p(t)[1]/-2})`)}),R(U,k)}),O(ue),O(H),O(N),Ct(N,U=>J(T,U),()=>p(T)),Y(()=>{q(N,"id",n()),Rt(N,`svelte-fa svelte-fa-base ${i()??""} svelte-bvo74f`),q(N,"style",r()),q(N,"viewBox",`0 0 ${p(t)[0]??""} ${p(t)[1]??""}`),M(N,"pulse",A()),M(N,"svelte-fa-size-lg",c()==="lg"),M(N,"svelte-fa-size-sm",c()==="sm"),M(N,"svelte-fa-size-xs",c()==="xs"),M(N,"svelte-fa-fw",y()),M(N,"svelte-fa-pull-left",f()==="left"),M(N,"svelte-fa-pull-right",f()==="right"),M(N,"spin",m()),q(H,"transform",`translate(${p(t)[0]/2} ${p(t)[1]/2})`),q(H,"transform-origin",`${p(t)[0]/4} 0`),q(ue,"transform",p(s))}),R(G,N)}),R(a,j),ge()}function Se(a){const e=a-1;return e*e*e+1}const Kt=a=>a;function Xt(a){const e=a-1;return e*e*e+1}function xe(a){const e=typeof a=="string"&&a.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[a,"px"]}function Jt(a,{delay:e=0,duration:t=400,easing:s=Kt}={}){const i=+getComputedStyle(a).opacity;return{delay:e,duration:t,easing:s,css:n=>`opacity: ${n*i}`}}function Zt(a,{delay:e=0,duration:t=400,easing:s=Xt,x:i=0,y:n=0,opacity:r=0}={}){const u=getComputedStyle(a),l=+u.opacity,c=u.transform==="none"?"":u.transform,o=l*(1-r),[y,f]=xe(i),[v,_]=xe(n);return{delay:e,duration:t,easing:s,css:(w,g)=>`
			transform: ${c} translate(${(1-w)*y}${f}, ${(1-w)*v}${_});
			opacity: ${l-o*g}`}}var $t=(a,e)=>{e.onClose()},ea=()=>{},ta=$('<div class="inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-current border-e-transparent align-[-0.125em] text-primary motion-reduce:animate-[spin_1.5s_linear_infinite]" role="status"><span class="!absolute !-m-px !h-px !w-px !overflow-hidden !whitespace-nowrap !border-0 !p-0 ![clip:rect(0,0,0,0)]">Loading...</span></div>'),aa=async(a,e)=>{await Ye.lock({orientation:"landscape"}),At("/controller/"+p(e).device.deviceId)},sa=$('<button class="unstyledButton"><div class="bluetoothDeviceContainer svelte-8m60mu"><div class="bluetoothDevice svelte-8m60mu"><div class="bluetoothIcon svelte-8m60mu"><!></div> <div class="bluetoothDeviceDetails svelte-8m60mu"><h3> </h3> <p class="svelte-8m60mu"> </p></div></div></div></button>'),ia=$('<div class="bluetoothDevicesContainer svelte-8m60mu"></div>'),na=$('<main><div class="overlay svelte-8m60mu"></div> <div class="modal svelte-8m60mu"><div class="modalContainer svelte-8m60mu"><div class="top"><div class="topInfo svelte-8m60mu"><h1 class="svelte-8m60mu"> </h1> <button class="unstyled-button closeButton svelte-8m60mu"><!></button></div></div> <div class="devicesList flex items-center justify-center m-3"><!></div></div></div></main>');function ra(a,e){pe(e,!0);let t=E(e,"bluetoothDevices",7);t(t().filter((n,r,u)=>r===u.findIndex(l=>l.device.deviceId===n.device.deviceId)));var s=Be(),i=oe(s);Z(i,()=>e.opened,n=>{var r=na(),u=L(r);u.__click=[$t,e],u.__keydown=[ea],q(u,"aria-hidden",!0);var l=z(u,2),c=L(l),o=L(c),y=L(o),f=L(y),v=L(f,!0);O(f);var _=z(f,2);_.__click=function(...m){var A;(A=e.onClose)==null||A.apply(this,m)};var w=L(_);me(w,{icon:Ft,rotate:"45",size:"1.8x"}),O(_),O(y),O(o);var g=z(o,2),h=L(g);Z(h,()=>t().length<=0,m=>{var A=ta();R(m,A)},m=>{var A=ia();St(A,21,()=>t().filter(C=>!!C.device.name).sort((C,b)=>(b.rssi||0)-(C.rssi||0)),qt,(C,b)=>{var S=sa();S.__click=[aa,b];var x=L(S),I=L(x),T=L(I),j=L(T);me(j,{icon:Wt,size:"1.25x"}),O(T);var ee=z(T,2),G=L(ee),N=L(G,!0);O(G);var Q=z(G,2),H=L(Q,!0);O(Q),O(ee),O(I),O(x),O(S),Y(()=>{ne(N,p(b).device.name),ne(H,p(b).device.deviceId)}),R(C,S)}),O(A),R(m,A)}),O(g),O(c),O(l),O(r),Y(()=>ne(v,e.title)),qe(3,u,()=>Jt,()=>({duration:200,easing:Se})),qe(3,l,()=>Zt,()=>({duration:250,y:200,easing:Se})),R(n,r)}),R(a,s),ge()}Ue(["click","keydown"]);var Te;(function(a){a[a.SCAN_MODE_LOW_POWER=0]="SCAN_MODE_LOW_POWER",a[a.SCAN_MODE_BALANCED=1]="SCAN_MODE_BALANCED",a[a.SCAN_MODE_LOW_LATENCY=2]="SCAN_MODE_LOW_LATENCY"})(Te||(Te={}));var ke;(function(a){a[a.CONNECTION_PRIORITY_BALANCED=0]="CONNECTION_PRIORITY_BALANCED",a[a.CONNECTION_PRIORITY_HIGH=1]="CONNECTION_PRIORITY_HIGH",a[a.CONNECTION_PRIORITY_LOW_POWER=2]="CONNECTION_PRIORITY_LOW_POWER"})(ke||(ke={}));function oa(a){return new DataView(Uint8Array.from(a).buffer)}function la(a){return Array.from(new Uint8Array(a.buffer,a.byteOffset,a.byteLength))}function ua(a){return`0000${a.toString(16).padStart(4,"0")}-0000-1000-8000-00805f9b34fb`}function ca(a){const e=[];let t,s,i=1,n=0;for(t=0;t<a.length;t++)s=a.charCodeAt(t),(s>47&&s<58||s>64&&s<71||s>96&&s<103)&&(n=n<<4^(s>64?s+9:s)&15,(i^=1)&&e.push(n&255));return oa(e)}function ye(a){return la(a).map(e=>{let t=e.toString(16);return t.length==1&&(t="0"+t),t}).join(" ")}function La(a){if(typeof a=="string")return a;if(typeof a=="number")return ua(a);throw new Error("Invalid UUID")}function Ca(a){const e={};if(a)return a.forEach((t,s)=>{e[s.toString()]=t}),e}const d=We("BluetoothLe",{web:()=>Fe(()=>import("./web.DCfE97fL.js"),__vite__mapDeps([2,1]),import.meta.url).then(a=>new a.BluetoothLeWeb)}),fa=()=>{let a=Promise.resolve();return e=>new Promise((t,s)=>{a=a.then(()=>e()).then(t).catch(s)})};function he(a){return a?fa():e=>e()}function D(a){if(typeof a!="string")throw new Error(`Invalid UUID type ${typeof a}. Expected string.`);if(a=a.toLowerCase(),!(a.search(/^[0-9a-f]{8}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{12}$/)>=0))throw new Error(`Invalid UUID format ${a}. Expected 128 bit string (e.g. "0000180d-0000-1000-8000-00805f9b34fb").`);return a}class va{constructor(){this.scanListener=null,this.eventListeners=new Map,this.queue=he(!0)}enableQueue(){this.queue=he(!0)}disableQueue(){this.queue=he(!1)}async initialize(e){await this.queue(async()=>{await d.initialize(e)})}async isEnabled(){return await this.queue(async()=>(await d.isEnabled()).value)}async requestEnable(){await this.queue(async()=>{await d.requestEnable()})}async enable(){await this.queue(async()=>{await d.enable()})}async disable(){await this.queue(async()=>{await d.disable()})}async startEnabledNotifications(e){await this.queue(async()=>{var t;const s="onEnabledChanged";await((t=this.eventListeners.get(s))===null||t===void 0?void 0:t.remove());const i=await d.addListener(s,n=>{e(n.value)});this.eventListeners.set(s,i),await d.startEnabledNotifications()})}async stopEnabledNotifications(){await this.queue(async()=>{var e;const t="onEnabledChanged";await((e=this.eventListeners.get(t))===null||e===void 0?void 0:e.remove()),this.eventListeners.delete(t),await d.stopEnabledNotifications()})}async isLocationEnabled(){return await this.queue(async()=>(await d.isLocationEnabled()).value)}async openLocationSettings(){await this.queue(async()=>{await d.openLocationSettings()})}async openBluetoothSettings(){await this.queue(async()=>{await d.openBluetoothSettings()})}async openAppSettings(){await this.queue(async()=>{await d.openAppSettings()})}async setDisplayStrings(e){await this.queue(async()=>{await d.setDisplayStrings(e)})}async requestDevice(e){return e=e?this.validateRequestBleDeviceOptions(e):void 0,await this.queue(async()=>await d.requestDevice(e))}async requestLEScan(e,t){e=this.validateRequestBleDeviceOptions(e),await this.queue(async()=>{var s;await((s=this.scanListener)===null||s===void 0?void 0:s.remove()),this.scanListener=await d.addListener("onScanResult",i=>{const n=Object.assign(Object.assign({},i),{manufacturerData:this.convertObject(i.manufacturerData),serviceData:this.convertObject(i.serviceData),rawAdvertisement:i.rawAdvertisement?this.convertValue(i.rawAdvertisement):void 0});t(n)}),await d.requestLEScan(e)})}async stopLEScan(){await this.queue(async()=>{var e;await((e=this.scanListener)===null||e===void 0?void 0:e.remove()),this.scanListener=null,await d.stopLEScan()})}async getDevices(e){if(!Array.isArray(e))throw new Error("deviceIds must be an array");return this.queue(async()=>(await d.getDevices({deviceIds:e})).devices)}async getConnectedDevices(e){if(!Array.isArray(e))throw new Error("services must be an array");return e=e.map(D),this.queue(async()=>(await d.getConnectedDevices({services:e})).devices)}async getBondedDevices(){return this.queue(async()=>(await d.getBondedDevices()).devices)}async connect(e,t,s){await this.queue(async()=>{var i;if(t){const n=`disconnected|${e}`;await((i=this.eventListeners.get(n))===null||i===void 0?void 0:i.remove());const r=await d.addListener(n,()=>{t(e)});this.eventListeners.set(n,r)}await d.connect(Object.assign({deviceId:e},s))})}async createBond(e,t){await this.queue(async()=>{await d.createBond(Object.assign({deviceId:e},t))})}async isBonded(e){return await this.queue(async()=>(await d.isBonded({deviceId:e})).value)}async disconnect(e){await this.queue(async()=>{await d.disconnect({deviceId:e})})}async getServices(e){return await this.queue(async()=>(await d.getServices({deviceId:e})).services)}async discoverServices(e){await this.queue(async()=>{await d.discoverServices({deviceId:e})})}async getMtu(e){return await this.queue(async()=>(await d.getMtu({deviceId:e})).value)}async requestConnectionPriority(e,t){await this.queue(async()=>{await d.requestConnectionPriority({deviceId:e,connectionPriority:t})})}async readRssi(e){return await this.queue(async()=>{const s=await d.readRssi({deviceId:e});return parseFloat(s.value)})}async read(e,t,s,i){return t=D(t),s=D(s),await this.queue(async()=>{const r=await d.read(Object.assign({deviceId:e,service:t,characteristic:s},i));return this.convertValue(r.value)})}async write(e,t,s,i,n){return t=D(t),s=D(s),this.queue(async()=>{if(!(i!=null&&i.buffer))throw new Error("Invalid data.");let r=i;_e.getPlatform()!=="web"&&(r=ye(i)),await d.write(Object.assign({deviceId:e,service:t,characteristic:s,value:r},n))})}async writeWithoutResponse(e,t,s,i,n){t=D(t),s=D(s),await this.queue(async()=>{if(!(i!=null&&i.buffer))throw new Error("Invalid data.");let r=i;_e.getPlatform()!=="web"&&(r=ye(i)),await d.writeWithoutResponse(Object.assign({deviceId:e,service:t,characteristic:s,value:r},n))})}async readDescriptor(e,t,s,i,n){return t=D(t),s=D(s),i=D(i),await this.queue(async()=>{const u=await d.readDescriptor(Object.assign({deviceId:e,service:t,characteristic:s,descriptor:i},n));return this.convertValue(u.value)})}async writeDescriptor(e,t,s,i,n,r){return t=D(t),s=D(s),i=D(i),this.queue(async()=>{if(!(n!=null&&n.buffer))throw new Error("Invalid data.");let u=n;_e.getPlatform()!=="web"&&(u=ye(n)),await d.writeDescriptor(Object.assign({deviceId:e,service:t,characteristic:s,descriptor:i,value:u},r))})}async startNotifications(e,t,s,i){t=D(t),s=D(s),await this.queue(async()=>{var n;const r=`notification|${e}|${t}|${s}`;await((n=this.eventListeners.get(r))===null||n===void 0?void 0:n.remove());const u=await d.addListener(r,l=>{i(this.convertValue(l==null?void 0:l.value))});this.eventListeners.set(r,u),await d.startNotifications({deviceId:e,service:t,characteristic:s})})}async stopNotifications(e,t,s){t=D(t),s=D(s),await this.queue(async()=>{var i;const n=`notification|${e}|${t}|${s}`;await((i=this.eventListeners.get(n))===null||i===void 0?void 0:i.remove()),this.eventListeners.delete(n),await d.stopNotifications({deviceId:e,service:t,characteristic:s})})}validateRequestBleDeviceOptions(e){return e.services&&(e.services=e.services.map(D)),e.optionalServices&&(e.optionalServices=e.optionalServices.map(D)),e}convertValue(e){return typeof e=="string"?ca(e):e===void 0?new DataView(new ArrayBuffer(0)):e}convertObject(e){if(e===void 0)return;const t={};for(const s of Object.keys(e))t[s]=this.convertValue(e[s]);return t}}const Re=new va;var da=(a,e,t)=>{e.opened=!0,t()},_a=$('<!> <main class="svelte-j8au8c"><button class="unstyled-button add-device-button svelte-j8au8c"><h1 class="svelte-j8au8c">Add Device</h1> <!></button></main>',1);function Da(a,e){pe(e,!0);let t=ae({opened:!1,title:"Add Device",onClose:()=>{t.opened=!1}}),s=Ot(ae([]));const i=async()=>{J(s,ae([])),await Re.requestLEScan({},o=>{console.log(o.device.deviceId),p(s).some(y=>y.device.deviceId===o.device.deviceId)||J(s,ae([...p(s),o]))})};Dt(async()=>{Ye.lock({orientation:"portrait"}),Re.initialize()});var n=_a(),r=oe(n);ra(r,{get opened(){return t.opened},get onClose(){return t.onClose},title:"Add Device",get bluetoothDevices(){return p(s)}});var u=z(r,2),l=L(u);l.__click=[da,t,i];var c=z(L(l),2);me(c,{icon:Ut,size:"1.3x"}),O(l),O(u),R(a,n),ge()}Ue(["click"]);export{Da as _,ca as h,Ca as m,La as w};
